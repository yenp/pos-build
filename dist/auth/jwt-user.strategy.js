"use strict";var __decorate=this&&this.__decorate||function(e,t,r,s){var a,o=arguments.length,c=o<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,r):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,r,s);else for(var i=e.length-1;0<=i;i--)(a=e[i])&&(c=(o<3?a(c):3<o?a(t,r,c):a(t,r))||c);return 3<o&&c&&Object.defineProperty(t,r,c),c},__metadata=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};Object.defineProperty(exports,"__esModule",{value:!0}),exports.JwtUserStrategy=void 0;const common_1=require("@nestjs/common"),passport_1=require("@nestjs/passport"),passport_jwt_1=require("passport-jwt"),auth_service_1=require("./auth.service");let JwtUserStrategy=class extends(0,passport_1.PassportStrategy)(passport_jwt_1.Strategy,"jwt-user"){constructor(e){super({jwtFromRequest:passport_jwt_1.ExtractJwt.fromAuthHeaderAsBearerToken(),secretOrKey:process.env.SECRET_KEY}),this.authService=e}async validate(e){return!e.is_customer&&(e=await this.authService.validateUser(e))?{id:e.id}:null}};exports.JwtUserStrategy=JwtUserStrategy,exports.JwtUserStrategy=JwtUserStrategy=__decorate([(0,common_1.Injectable)(),__metadata("design:paramtypes",[auth_service_1.AuthService])],JwtUserStrategy);